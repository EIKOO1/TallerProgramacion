programa ejercicio3
procesos
  proceso irALaEsquina(E av:numero;E ca:numero;ES cantFlores:numero)
  variables
    posAvInicial:numero
    posCaInicial:numero
  comenzar
    posAvInicial:=PosAv
    posCaInicial:=PosCa
    BloquearEsquina(av,ca)
    Pos(av,ca)
    mientras (HayFlorEnLaEsquina)
      tomarFlor
      cantFlores:=cantFlores+1
      Pos(posAvInicial,posCaInicial)
      LiberarEsquina(av,ca)
      BloquearEsquina(av,ca)
      Pos(av,ca)
    Pos(posAvInicial,posCaInicial)
    LiberarEsquina(av,ca)
  fin
  proceso mandarMensajes(E av:numero;E ca:numero)
  comenzar
    EnviarMensaje(av,r1)
    EnviarMensaje(ca,r1)
    EnviarMensaje(av,r2)
    EnviarMensaje(ca,r2)
    EnviarMensaje(av,r3)
    EnviarMensaje(ca,r3)
    EnviarMensaje(av,r4)
    EnviarMensaje(ca,r4)
  fin
  proceso recibirMensajes(ES c1:numero;ES c2:numero;ES c3:numero;ES c4:numero)
  variables
    id:numero
  comenzar
    repetir 4
      RecibirMensaje(id,*)
      si (id=1)
        RecibirMensaje(c1,r1)
      sino
        si(id=2)
          RecibirMensaje(c2,r2)
        sino
          si(id=3)
            RecibirMensaje(c3,r3)
          sino
            si(id=4)
              RecibirMensaje(c4,r4)
  fin
  proceso CalcularMaximo(E c1:numero;E c2:numero;E c3:numero;E c4:numero;ES RobotMaximo:numero)
  variables
    max:numero
  comenzar
    max:=-1
    si(c1>max)
      max:=c1
      RobotMaximo:=1
    si(c2>max)
      max:=c2
      RobotMaximo:=2
    si(c3>max)
      max:=c3
      RobotMaximo:=3
    si(c4>max)
      RobotMaximo:=4
  fin
areas
  area1:AreaP(2,2,10,10)
  areaJefe:AreaP(1,1,1,1)
  ini1:AreaP(2,1,2,1)
  ini2:AreaP(3,1,3,1)
  ini3:AreaP(4,1,4,1)
  ini4:AreaP(5,1,5,1)
robots
  robot robot1
  variables
    cantFlores:numero
    posAvJefe:numero
    posCaJefe:numero
    id:numero
  comenzar
    cantFlores:=0
    RecibirMensaje(id,rj)
    RecibirMensaje(posAvJefe,rj)
    RecibirMensaje(posCaJefe,rj)
    irALaEsquina(posAvJefe,posCaJefe,cantFlores)
    EnviarMensaje(id,rj)
    EnviarMensaje(cantFlores,rj) 
  fin
  robot robotjefe
  variables
    cant1,cant2,cant3,cant4:numero
    id:numero
    posAvRandom:numero
    posCaRandom:numero
    robotMax:numero
  comenzar
    EnviarMensaje(1,r1)
    EnviarMensaje(2,r2)
    EnviarMensaje(3,r3)
    EnviarMensaje(4,r4)
    Random(posAvRandom,2,10)
    Random(posCaRandom,2,10)
    mandarMensajes(posAvRandom,posCaRandom)
    recibirMensajes(cant1,cant2,cant3,cant4)
    CalcularMaximo(cant1,cant2,cant3,cant4,robotMax)
    Informar(robotMax)   
  fin
variables
  r1:robot1
  r2:robot1
  r3:robot1
  r4:robot1
  rj:robotjefe
comenzar
  AsignarArea(r1,area1)
  AsignarArea(r2,area1)
  AsignarArea(r3,area1)
  AsignarArea(r4,area1)
  AsignarArea(r1,ini1)
  AsignarArea(r2,ini2)
  AsignarArea(r3,ini3)
  AsignarArea(r4,ini4)    
  AsignarArea(rj,areaJefe)
  Iniciar(rj,1,1)
  Iniciar(r1,2,1)
  Iniciar(r2,3,1)
  Iniciar(r3,4,1)
  Iniciar(r4,5,1)
fin